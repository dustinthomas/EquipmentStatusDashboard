import{_ as v,p as g,s as k,o as a,c as n,a as t,g as y,t as r,b as e,w as h,e as m,h as p,l as _,F as D,r as T,k as H,x as w,y as V,i as x}from"./index-BDGxoy4u.js";import{u as C}from"./toolDetail-gsCzoaol.js";import{_ as S}from"./StatusBadge-1-ZXL-0m.js";import{E as F}from"./EmptyState-CjGN3KU0.js";const N={class:"tool-history-view"},B=["href"],U={class:"card tool-history-header"},$={class:"tool-history-subtitle"},E={class:"card filter-card"},A={class:"filter-row"},L={class:"filter-group"},M={class:"filter-group"},I={class:"filter-group filter-group-buttons"},R=["disabled"],j=["disabled"],q={key:0,class:"alert alert-error"},z={class:"card history-card"},G={class:"table-container"},J={class:"table history-table"},K={key:0},O={key:1},P={colspan:"6"},Q={class:"history-timestamp"},W=["title"],X=["title"],Y={key:0,class:"history-footer"},Z={class:"history-count"},tt={__name:"ToolHistoryView",setup(st){const u=V(),f=x(),o=C(),d=w(()=>u.params.id);g(()=>{o.fetchHistory(d.value)}),k(()=>u.params.id,l=>{l&&o.fetchHistory(l)});function b(){f.push(`/vue/tools/${d.value}`)}function c(l){if(!l)return"-";try{return new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit"})}catch{return l}}return(l,s)=>(a(),n("div",N,[t("a",{href:`/vue/tools/${d.value}`,class:"back-link",onClick:y(b,["prevent"])}," â† Back to Tool Details ",8,B),t("div",U,[s[5]||(s[5]=t("h1",{class:"tool-history-title"},"Status History",-1)),t("p",$,r(e(o).history.toolName||"Loading..."),1)]),t("div",E,[t("form",{onSubmit:s[4]||(s[4]=y(i=>e(o).applyHistoryFilters(d.value),["prevent"])),class:"filter-form"},[t("div",A,[t("div",L,[s[6]||(s[6]=t("label",{class:"filter-label"},"From Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=i=>e(o).history.fromDate=i),class:"form-input"},null,512),[[m,e(o).history.fromDate]])]),t("div",M,[s[7]||(s[7]=t("label",{class:"filter-label"},"To Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":s[1]||(s[1]=i=>e(o).history.toDate=i),class:"form-input"},null,512),[[m,e(o).history.toDate]])]),t("div",I,[s[8]||(s[8]=t("button",{type:"submit",class:"btn btn-primary btn-sm"}," Apply ",-1)),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:s[2]||(s[2]=i=>e(o).clearHistoryFilters(d.value)),disabled:!e(o).hasActiveHistoryFilters}," Clear ",8,R),t("button",{type:"button",class:"btn btn-outline btn-sm",onClick:s[3]||(s[3]=i=>e(o).exportHistoryCsv(d.value)),disabled:e(o).history.events.length===0}," Export CSV ",8,j)])])],32)]),e(o).history.error?(a(),n("div",q,r(e(o).history.error),1)):p("",!0),t("div",z,[t("div",G,[t("table",J,[s[10]||(s[10]=t("thead",null,[t("tr",null,[t("th",null,"Timestamp"),t("th",null,"Status"),t("th",null,"Issue"),t("th",null,"Comment"),t("th",null,"ETA to Up"),t("th",null,"Updated By")])],-1)),t("tbody",null,[e(o).history.loading?(a(),n("tr",K,[...s[9]||(s[9]=[t("td",{colspan:"6",class:"loading-cell"},[t("div",{class:"loading-spinner"}),t("span",null,"Loading history...")],-1)])])):e(o).history.events.length===0?(a(),n("tr",O,[t("td",P,[_(F,{title:"No history found",message:e(o).hasActiveHistoryFilters?"Try adjusting the date range":"No status changes have been recorded yet"},null,8,["message"])])])):(a(!0),n(D,{key:2},T(e(o).history.events,i=>(a(),n("tr",{key:i.id},[t("td",Q,r(c(i.created_at)),1),t("td",null,[_(S,{status:i.state},null,8,["status"])]),t("td",{class:"history-issue",title:i.issue_description},r(i.issue_description||"-"),9,W),t("td",{class:"history-comment",title:i.comment},r(i.comment||"-"),9,X),t("td",null,r(i.eta_to_up?c(i.eta_to_up):"-"),1),t("td",null,r(i.created_by||"Unknown"),1)]))),128))])])]),!e(o).history.loading&&e(o).history.events.length>0?(a(),n("div",Y,[t("span",Z,r(e(o).history.events.length),1),H(" status change"+r(e(o).history.events.length!==1?"s":"")+" found ",1)])):p("",!0)])]))}},lt=v(tt,[["__scopeId","data-v-b14d0aa1"]]);export{lt as default};
