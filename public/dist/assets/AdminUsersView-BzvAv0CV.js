import{_ as w,o as n,q as _,a as s,t as i,b as e,g as M,c as u,h as c,k as m,w as b,e as v,v as h,r as k,F as U,j as p,T as C,p as S,l as P,i as A}from"./index-BDGxoy4u.js";import{u as y}from"./admin-jWCykmMJ.js";import{E as N}from"./EmptyState-CjGN3KU0.js";const V={class:"modal"},R={class:"modal-header"},x={class:"modal-title"},E=["disabled"],T={class:"modal-body"},D={key:0,class:"alert alert-success"},q={key:1,class:"alert alert-error"},L={class:"form-group"},B=["disabled"],F={class:"form-group"},I=["disabled"],j={key:2,class:"form-group"},z=["disabled"],Y={class:"form-group"},G=["disabled"],H=["value"],J={key:0,class:"role-preview"},K={class:"modal-actions"},O=["disabled"],Q=["disabled"],W={key:0,class:"loading-spinner loading-spinner-sm"},X={__name:"UserFormModal",setup($){const t=y();return(a,o)=>(n(),_(C,{to:"body"},[s("div",{class:"modal-overlay",onClick:o[7]||(o[7]=M(d=>e(t).closeUserModal(),["self"]))},[s("div",V,[s("div",R,[s("h3",x,i(e(t).userModal.mode==="create"?"Add New User":"Edit User"),1),s("button",{class:"modal-close",onClick:o[0]||(o[0]=d=>e(t).closeUserModal()),disabled:e(t).userModal.submitting}," × ",8,E)]),s("div",T,[s("form",{onSubmit:o[6]||(o[6]=M(d=>e(t).submitUserModal(),["prevent"]))},[e(t).userModal.successMessage?(n(),u("div",D,i(e(t).userModal.successMessage),1)):c("",!0),e(t).userModal.error?(n(),u("div",q,i(e(t).userModal.error),1)):c("",!0),s("div",L,[o[8]||(o[8]=s("label",{class:"form-label"},[m(" Username "),s("span",{class:"required"},"*")],-1)),b(s("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=d=>e(t).userModal.username=d),class:"form-input",placeholder:"Enter username",disabled:e(t).userModal.submitting,autocomplete:"off"},null,8,B),[[v,e(t).userModal.username]])]),s("div",F,[o[9]||(o[9]=s("label",{class:"form-label"},[m(" Display Name "),s("span",{class:"required"},"*")],-1)),b(s("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=d=>e(t).userModal.name=d),class:"form-input",placeholder:"Enter display name",disabled:e(t).userModal.submitting},null,8,I),[[v,e(t).userModal.name]])]),e(t).userModal.mode==="create"?(n(),u("div",j,[o[10]||(o[10]=s("label",{class:"form-label"},[m(" Password "),s("span",{class:"required"},"*")],-1)),b(s("input",{type:"password","onUpdate:modelValue":o[3]||(o[3]=d=>e(t).userModal.password=d),class:"form-input",placeholder:"Enter password",disabled:e(t).userModal.submitting,autocomplete:"new-password"},null,8,z),[[v,e(t).userModal.password]]),o[11]||(o[11]=s("span",{class:"form-help"},' Password can be changed later via "Reset Password" ',-1))])):c("",!0),s("div",Y,[o[12]||(o[12]=s("label",{class:"form-label"},"Role",-1)),b(s("select",{"onUpdate:modelValue":o[4]||(o[4]=d=>e(t).userModal.role=d),class:"form-select",disabled:e(t).userModal.submitting},[(n(!0),u(U,null,k(e(t).validRoles,d=>(n(),u("option",{key:d.value,value:d.value},i(d.label),9,H))),128))],8,G),[[h,e(t).userModal.role]]),e(t).userModal.role?(n(),u("div",J,[s("span",{class:p(["role-badge",`role-${e(t).userModal.role}`])},i(e(t).userModal.role),3)])):c("",!0)]),s("div",K,[s("button",{type:"button",class:"btn btn-secondary",onClick:o[5]||(o[5]=d=>e(t).closeUserModal()),disabled:e(t).userModal.submitting}," Cancel ",8,O),s("button",{type:"submit",class:"btn btn-primary",disabled:e(t).userModal.submitting},[e(t).userModal.submitting?(n(),u("span",W)):c("",!0),m(" "+i(e(t).userModal.submitting?"Saving...":e(t).userModal.mode==="create"?"Create User":"Save Changes"),1)],8,Q)])],32)])])])]))}},Z=w(X,[["__scopeId","data-v-9d4286a8"]]),ss={class:"modal"},es={class:"modal-header"},ts=["disabled"],os={class:"modal-body"},ls={key:0,class:"alert alert-success"},as={key:1,class:"alert alert-error"},ds={class:"modal-description"},rs={class:"form-group"},ns=["disabled"],is={class:"modal-actions"},us=["disabled"],ms=["disabled"],cs={key:0,class:"loading-spinner loading-spinner-sm"},ps={__name:"PasswordResetModal",setup($){const t=y();return(a,o)=>(n(),_(C,{to:"body"},[s("div",{class:"modal-overlay",onClick:o[4]||(o[4]=M(d=>e(t).closePasswordModal(),["self"]))},[s("div",ss,[s("div",es,[o[5]||(o[5]=s("h3",{class:"modal-title"},"Reset Password",-1)),s("button",{class:"modal-close",onClick:o[0]||(o[0]=d=>e(t).closePasswordModal()),disabled:e(t).passwordModal.submitting}," × ",8,ts)]),s("div",os,[s("form",{onSubmit:o[3]||(o[3]=M(d=>e(t).submitPasswordModal(),["prevent"]))},[e(t).passwordModal.successMessage?(n(),u("div",ls,i(e(t).passwordModal.successMessage),1)):c("",!0),e(t).passwordModal.error?(n(),u("div",as,i(e(t).passwordModal.error),1)):c("",!0),s("p",ds,[o[6]||(o[6]=m(" Set a new password for ",-1)),s("strong",null,i(e(t).passwordModal.userName),1)]),s("div",rs,[o[7]||(o[7]=s("label",{class:"form-label"},[m(" New Password "),s("span",{class:"required"},"*")],-1)),b(s("input",{type:"password","onUpdate:modelValue":o[1]||(o[1]=d=>e(t).passwordModal.password=d),class:"form-input",placeholder:"Enter new password",disabled:e(t).passwordModal.submitting,autocomplete:"new-password"},null,8,ns),[[v,e(t).passwordModal.password]])]),s("div",is,[s("button",{type:"button",class:"btn btn-secondary",onClick:o[2]||(o[2]=d=>e(t).closePasswordModal()),disabled:e(t).passwordModal.submitting}," Cancel ",8,us),s("button",{type:"submit",class:"btn btn-primary",disabled:e(t).passwordModal.submitting},[e(t).passwordModal.submitting?(n(),u("span",cs)):c("",!0),m(" "+i(e(t).passwordModal.submitting?"Resetting...":"Reset Password"),1)],8,ms)])],32)])])])]))}},bs=w(ps,[["__scopeId","data-v-4c6592b1"]]),vs={class:"admin-view"},gs={key:0,class:"alert alert-error"},_s={class:"card admin-toolbar"},Ms={class:"admin-toolbar-row"},ws={class:"admin-search-group"},ys={class:"card admin-table-card"},$s={class:"table-container"},fs={class:"table admin-users-table"},ks={key:0},Us={key:1},Cs={colspan:"6"},hs={class:"user-username"},Ss={class:"admin-actions-cell"},Ps=["onClick"],As=["onClick"],Ns=["onClick"],Vs={key:0,class:"admin-table-footer"},Rs={__name:"AdminUsersView",setup($){const t=A(),a=y();S(()=>{a.switchTab("users"),a.users.items.length===0&&a.fetchUsers()});function o(){t.push("/admin/tools")}function d(g){if(!g)return"Never";try{return new Date(g).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return g}}return(g,l)=>(n(),u("div",vs,[l[18]||(l[18]=s("div",{class:"page-header"},[s("h1",null,"Admin Panel"),s("p",null,"Manage tools and users")],-1)),s("div",{class:"admin-tabs"},[s("button",{class:"admin-tab",onClick:o}," Tools "),l[7]||(l[7]=s("button",{class:"admin-tab admin-tab-active"}," Users ",-1))]),e(a).users.error?(n(),u("div",gs,i(e(a).users.error),1)):c("",!0),s("div",_s,[s("div",Ms,[s("div",ws,[b(s("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=r=>e(a).users.search=r),class:"form-input admin-search-input",placeholder:"Search users..."},null,512),[[v,e(a).users.search]])]),s("button",{class:"btn btn-primary",onClick:l[1]||(l[1]=r=>e(a).openAddUserModal())}," + Add User ")])]),s("div",ys,[s("div",$s,[s("table",fs,[s("thead",null,[s("tr",null,[s("th",{class:p(["sortable-header",e(a).getUserSortClass("username")]),onClick:l[2]||(l[2]=r=>e(a).handleUserSortClick("username"))},[...l[8]||(l[8]=[m(" Username ",-1),s("span",{class:"sort-indicator"},null,-1)])],2),s("th",{class:p(["sortable-header",e(a).getUserSortClass("name")]),onClick:l[3]||(l[3]=r=>e(a).handleUserSortClick("name"))},[...l[9]||(l[9]=[m(" Name ",-1),s("span",{class:"sort-indicator"},null,-1)])],2),s("th",{class:p(["sortable-header",e(a).getUserSortClass("role")]),onClick:l[4]||(l[4]=r=>e(a).handleUserSortClick("role"))},[...l[10]||(l[10]=[m(" Role ",-1),s("span",{class:"sort-indicator"},null,-1)])],2),s("th",{class:p(["sortable-header",e(a).getUserSortClass("last_login_at")]),onClick:l[5]||(l[5]=r=>e(a).handleUserSortClick("last_login_at"))},[...l[11]||(l[11]=[m(" Last Login ",-1),s("span",{class:"sort-indicator"},null,-1)])],2),s("th",{class:p(["sortable-header",e(a).getUserSortClass("is_active")]),onClick:l[6]||(l[6]=r=>e(a).handleUserSortClick("is_active"))},[...l[12]||(l[12]=[m(" Active ",-1),s("span",{class:"sort-indicator"},null,-1)])],2),l[13]||(l[13]=s("th",null,"Actions",-1))])]),s("tbody",null,[e(a).users.loading?(n(),u("tr",ks,[...l[14]||(l[14]=[s("td",{colspan:"6",class:"loading-cell"},[s("div",{class:"loading-spinner"}),s("span",null,"Loading users...")],-1)])])):e(a).filteredUsers.length===0?(n(),u("tr",Us,[s("td",Cs,[P(N,{title:"No users found",message:e(a).users.search?"Try adjusting your search":"Click Add User to create your first user"},null,8,["message"])])])):(n(!0),u(U,{key:2},k(e(a).filteredUsers,r=>(n(),u("tr",{key:r.id,class:p({"admin-row-inactive":!r.is_active})},[s("td",hs,i(r.username),1),s("td",null,i(r.name),1),s("td",null,[s("span",{class:p(["role-badge",`role-${r.role}`])},i(r.role),3)]),s("td",null,i(d(r.last_login_at)),1),s("td",null,[s("span",{class:p(["active-badge",r.is_active?"active-badge-yes":"active-badge-no"])},i(r.is_active?"Yes":"No"),3)]),s("td",Ss,[s("button",{class:"btn btn-secondary btn-sm",onClick:f=>e(a).openEditUserModal(r)}," Edit ",8,Ps),s("button",{class:"btn btn-secondary btn-sm",onClick:f=>e(a).openPasswordModal(r)}," Reset Password ",8,As),s("button",{class:p(["btn btn-sm",r.is_active?"btn-outline-danger":"btn-outline-success"]),onClick:f=>e(a).toggleUserActive(r)},i(r.is_active?"Deactivate":"Activate"),11,Ns)])],2))),128))])])]),!e(a).users.loading&&e(a).filteredUsers.length>0?(n(),u("div",Vs,[l[15]||(l[15]=m(" Showing ",-1)),s("strong",null,i(e(a).filteredUsers.length),1),l[16]||(l[16]=m(" of ",-1)),s("strong",null,i(e(a).users.items.length),1),l[17]||(l[17]=m(" users ",-1))])):c("",!0)]),e(a).userModal.visible?(n(),_(Z,{key:1})):c("",!0),e(a).passwordModal.visible?(n(),_(bs,{key:2})):c("",!0)]))}},Ds=w(Rs,[["__scopeId","data-v-f1912538"]]);export{Ds as default};
