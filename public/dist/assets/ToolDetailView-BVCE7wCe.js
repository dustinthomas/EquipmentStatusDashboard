import{_ as g,o as n,q as F,a as t,b as s,g as y,c as r,t as d,h as u,k as f,w as _,v as w,r as D,F as U,l as k,e as v,T,p as C,s as x,x as V,i as N,y as B}from"./index-BDGxoy4u.js";import{u as $}from"./toolDetail-gsCzoaol.js";import{_ as S}from"./StatusBadge-1-ZXL-0m.js";const I={class:"modal"},M={class:"modal-header"},L=["disabled"],E={class:"modal-body"},q={key:0,class:"alert alert-error"},A={class:"form-group"},R=["disabled"],H=["value"],z={key:0,class:"status-preview"},P={class:"form-group"},W=["disabled"],j={class:"form-group"},G=["disabled"],J={key:1,class:"form-group"},K=["disabled"],O={class:"modal-actions"},Q=["disabled"],X=["disabled"],Y={key:0,class:"loading-spinner loading-spinner-sm"},Z={__name:"StatusUpdateModal",props:{toolId:{type:[Number,String],required:!0}},emits:["updated"],setup(h,{emit:c}){const m=h,a=c,o=$();async function p(){await o.submitStatusForm(m.toolId)&&(a("updated"),window.showToast&&window.showToast("Status updated successfully","success"))}return(b,e)=>(n(),F(T,{to:"body"},[t("div",{class:"modal-overlay",onClick:e[6]||(e[6]=y(l=>s(o).closeStatusForm(),["self"]))},[t("div",I,[t("div",M,[e[7]||(e[7]=t("h3",{class:"modal-title"},"Update Status",-1)),t("button",{class:"modal-close",onClick:e[0]||(e[0]=l=>s(o).closeStatusForm()),disabled:s(o).statusForm.submitting}," × ",8,L)]),t("div",E,[t("form",{onSubmit:y(p,["prevent"])},[s(o).statusForm.error?(n(),r("div",q,d(s(o).statusForm.error),1)):u("",!0),t("div",A,[e[9]||(e[9]=t("label",{class:"form-label"},[f(" Status "),t("span",{class:"required"},"*")],-1)),_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s(o).statusForm.state=l),class:"form-select",disabled:s(o).statusForm.submitting},[e[8]||(e[8]=t("option",{value:""},"Select status...",-1)),(n(!0),r(U,null,D(s(o).validStates,l=>(n(),r("option",{key:l.value,value:l.value},d(l.label),9,H))),128))],8,R),[[w,s(o).statusForm.state]]),s(o).statusForm.state?(n(),r("div",z,[k(S,{status:s(o).statusForm.state},null,8,["status"])])):u("",!0)]),t("div",P,[e[10]||(e[10]=t("label",{class:"form-label"},"Issue Description",-1)),_(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>s(o).statusForm.issue_description=l),class:"form-textarea",rows:"2",placeholder:"Describe the issue...",disabled:s(o).statusForm.submitting},null,8,W),[[v,s(o).statusForm.issue_description]])]),t("div",j,[e[11]||(e[11]=t("label",{class:"form-label"},"Comment",-1)),_(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>s(o).statusForm.comment=l),class:"form-textarea",rows:"2",placeholder:"Additional notes...",disabled:s(o).statusForm.submitting},null,8,G),[[v,s(o).statusForm.comment]])]),s(o).shouldShowEtaField?(n(),r("div",J,[e[12]||(e[12]=t("label",{class:"form-label"},"ETA to Up",-1)),_(t("input",{type:"datetime-local","onUpdate:modelValue":e[4]||(e[4]=l=>s(o).statusForm.eta_to_up=l),class:"form-input",disabled:s(o).statusForm.submitting},null,8,K),[[v,s(o).statusForm.eta_to_up]]),e[13]||(e[13]=t("span",{class:"form-help"}," When do you expect the tool to be back up? ",-1))])):u("",!0),t("div",O,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[5]||(e[5]=l=>s(o).closeStatusForm()),disabled:s(o).statusForm.submitting}," Cancel ",8,Q),t("button",{type:"submit",class:"btn btn-primary",disabled:s(o).statusForm.submitting},[s(o).statusForm.submitting?(n(),r("span",Y)):u("",!0),f(" "+d(s(o).statusForm.submitting?"Saving...":"Save Changes"),1)],8,X)])],32)])])])]))}},tt=g(Z,[["__scopeId","data-v-43521b6a"]]),st={class:"tool-detail-view"},ot={key:0,class:"loading-container"},et={key:1,class:"alert alert-error"},at={key:2,class:"tool-detail"},lt={class:"card tool-detail-header"},it={class:"tool-detail-title-row"},nt={class:"tool-detail-name"},dt={class:"tool-detail-subtitle"},rt={class:"tool-detail-area"},ut={key:0,class:"tool-detail-bay"},ct={key:1,class:"tool-detail-criticality"},mt={class:"card tool-detail-status"},pt={class:"tool-detail-grid"},_t={class:"detail-item"},bt={class:"detail-value"},vt={class:"detail-item"},yt={class:"detail-value"},ft={key:0,class:"detail-item"},ht={class:"detail-value"},gt={class:"detail-item"},Ft={class:"detail-value"},kt={class:"detail-item"},$t={class:"detail-value"},St={class:"tool-detail-actions"},wt={__name:"ToolDetailView",setup(h){const c=B(),m=N(),a=$(),o=V(()=>c.params.id);C(()=>{a.fetchTool(o.value)}),x(()=>c.params.id,l=>{l&&a.fetchTool(l)});function p(){m.push("/vue")}function b(){m.push(`/vue/tools/${o.value}/history`)}function e(l){if(!l)return"-";try{return new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return l}}return(l,i)=>(n(),r("div",st,[t("a",{href:"/vue",class:"back-link",onClick:y(p,["prevent"])}," ← Back to Dashboard "),s(a).loading?(n(),r("div",ot,[...i[1]||(i[1]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Loading tool details...",-1)])])):s(a).error?(n(),r("div",et,[f(d(s(a).error)+" ",1),t("button",{class:"btn btn-secondary btn-sm mt-16",onClick:p}," Return to Dashboard ")])):s(a).tool?(n(),r("div",at,[t("div",lt,[t("div",it,[t("div",null,[t("h1",nt,d(s(a).tool.name),1),t("p",dt,[t("span",rt,d(s(a).tool.area),1),s(a).tool.bay?(n(),r("span",ut," / "+d(s(a).tool.bay),1)):u("",!0),s(a).tool.criticality?(n(),r("span",ct," • "+d(s(a).tool.criticality)+" criticality ",1)):u("",!0)])]),k(S,{status:s(a).tool.state,size:"large"},null,8,["status"])])]),t("div",mt,[i[7]||(i[7]=t("h2",{class:"card-section-title"},"Current Status Details",-1)),t("div",pt,[t("div",_t,[i[2]||(i[2]=t("span",{class:"detail-label"},"Issue Description",-1)),t("span",bt,d(s(a).tool.issue_description||"None"),1)]),t("div",vt,[i[3]||(i[3]=t("span",{class:"detail-label"},"Comment",-1)),t("span",yt,d(s(a).tool.comment||"None"),1)]),s(a).tool.state!=="UP"?(n(),r("div",ft,[i[4]||(i[4]=t("span",{class:"detail-label"},"ETA to Up",-1)),t("span",ht,d(s(a).tool.eta_to_up?e(s(a).tool.eta_to_up):"Not specified"),1)])):u("",!0),t("div",gt,[i[5]||(i[5]=t("span",{class:"detail-label"},"Last Updated",-1)),t("span",Ft,d(e(s(a).tool.updated_at)),1)]),t("div",kt,[i[6]||(i[6]=t("span",{class:"detail-label"},"Last Updated By",-1)),t("span",$t,d(s(a).tool.updated_by||"Unknown"),1)])]),t("div",St,[t("button",{class:"btn btn-primary",onClick:i[0]||(i[0]=Dt=>s(a).openStatusForm())}," Update Status "),t("button",{class:"btn btn-secondary",onClick:b}," View History ")])])])):u("",!0),s(a).statusForm.visible?(n(),F(tt,{key:3,"tool-id":o.value},null,8,["tool-id"])):u("",!0)]))}},xt=g(wt,[["__scopeId","data-v-f5ff7998"]]);export{xt as default};
